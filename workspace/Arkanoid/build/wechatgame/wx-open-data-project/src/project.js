window.__require=function e(n,t,r){function a(c,o){if(!t[c]){if(!n[c]){var s=c.split("/");if(s=s[s.length-1],!n[s]){var l="function"==typeof __require&&__require;if(!o&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}}var u=t[c]={exports:{}};n[c][0].call(u.exports,function(e){return a(n[c][1][e]||e)},u,u.exports,e,n,t,r)}return t[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<r.length;c++)a(r[c]);return a}({launch:[function(e,n,t){"use strict";cc._RF.push(n,"e53e6YiUd9FJLf8yIQu1n47","launch"),cc.Class({extends:cc.Component,properties:{content:cc.Node,prefab:cc.Prefab,userRankInfo:cc.Node},start:function(){var e=this;"undefined"!=typeof wx&&wx.onMessage(function(n){for(var t=0;t<e.content.children.length;t++){e.content.children[t].destroy()}"friendRank"==n.type?(e.initTips(),e.initUserScoreInfo(),e.initFriendRankInfo()):"updateMaxScore"==n.type?e.updateUserMaxScore:"playerRank"==n.type&&(e.initTips(),e.intiPlayerRank(n.message))})},initTips:function(){cc.game.renderType,cc.game.RENDER_TYPE_WEBGL},updateUserMaxScore:function(){this.userRankInfo.children.destroy()},initUserInfo:function(){var e=this;wx.getUserInfo({openIdList:["selfOpenId"],lang:"zh_CN",success:function(n){e.addUserInfo(n.data[0])},fail:function(e){console.error(e)}})},addUserInfo:function(e){this.userRankInfo.children.length<=0&&(cc.instantiate(this.prefab).parent=this.userRankInfo);var n=this.userRankInfo.children[0];n.x=0,n.getChildByName("userName").getComponent(cc.Label).string=e.nickName||e.nickname,cc.loader.load({url:e.avatarUrl,type:"png"},function(e,t){e&&console.error(e),n.getChildByName("mask").children[0].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)})},initUserScoreInfo:function(){var e=this;this.initUserInfo(),wx.getUserCloudStorage({keyList:["score"],success:function(n){e.addScore(n.KVDataList[0].value)}})},addScore:function(e){this.userRankInfo.children.length<=0&&(cc.instantiate(this.prefab).parent=this.userRankInfo);this.userRankInfo.children[0].getChildByName("score").getComponent(cc.Label).string=e||0},initFriendRankInfo:function(){var e=this;wx.getFriendCloudStorage({keyList:["score"],success:function(n){for(var t=e.rankUserScore(n),r=0;r<t.length;++r)e.createUserBlock(t[r])}})},createUserBlock:function(e){var n=cc.instantiate(this.prefab);n.parent=this.content,n.x=0,n.getChildByName("userName").getComponent(cc.Label).string=e.nickName||e.nickname,cc.loader.load({url:e.avatarUrl,type:"png"},function(e,t){e&&console.error(e),n.getChildByName("mask").children[0].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}),n.getChildByName("score").getComponent(cc.Label).string=e.KVDataList[0].value||0},rankUserScore:function(e){for(var n=[],t=0;t<e.data.length;++t)n.push(e.data[t]);return n.sort(this.rank),n},rank:function(e,n){return n.KVDataList[0].value-e.KVDataList[0].value},intiPlayerRank:function(e){var n=JSON.parse(e);for(var t in n){var r=n[t],a=t.split("*"),i=new Object;i.nickName=a[0].split('"')[1],i.avatarUrl=a[1].split('"')[0],i.score=r,this.createPlayerRankBlock(i)}},createPlayerRankBlock:function(e){var n=cc.instantiate(this.prefab);n.parent=this.content,n.x=0,n.getChildByName("userName").getComponent(cc.Label).string=e.nickName,cc.loader.load({url:e.avatarUrl,type:"png"},function(e,t){e&&console.error(e),n.getChildByName("mask").children[0].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}),n.getChildByName("score").getComponent(cc.Label).string=e.score}}),cc._RF.pop()},{}]},{},["launch"]);